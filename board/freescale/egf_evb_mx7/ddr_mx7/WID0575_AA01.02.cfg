/*
 * Copyright (C) 2015-2016 Freescale Semiconductor, Inc.
 *
 * SPDX-License-Identifier:	GPL-2.0+
 *
 * Refer docs/README.imxmage for more details about how-to configure
 * and create imximage boot image
 *
 * The syntax is taken as close as possible with the kwbimage
 */

#define __ASSEMBLY__
#include <config.h>

/* image version */

IMAGE_VERSION 2

/*
 * Boot Device : one of
 * spi/sd/nand/onenand, qspi/nor
 */

#ifdef CONFIG_SYS_BOOT_QSPI
BOOT_FROM	qspi
#elif defined(CONFIG_SYS_BOOT_EIMNOR)
BOOT_FROM	nor
#else
BOOT_FROM	sd
#endif

#ifdef CONFIG_SECURE_BOOT
CSF CONFIG_CSF_SIZE
#endif


/*
 * Device Configuration Data (DCD)
 *
 * Each entry must have the format:
 * Addr-type           Address        Value
 *
 * where:
 *	Addr-type register length (1,2 or 4 bytes)
 *	Address	  absolute address of the register
 *	value	  value to be stored in the register
 */

DATA 4 0x30340004 0x4F400005
/* Clear then set bit30 to ensure exit from DDR retention */
DATA 4 0x30360388 0x40000000
DATA 4 0x30360384 0x40000000

//=============================================================================														
// DDR Controller Registers														
//=============================================================================														
// Memory type:	DDR3													
// Manufacturer:	Intelligent Memory													
// Device Part Number:	IM8G16D3FCBG-125I													
// Clock Freq.: 	533MHz													
// Density per CS in Gb: 	16													
// Chip Selects used:	1													
// Number of Banks:	8													
// Row address:    	16													
// Column address: 	10													
// Data bus width:	32													
// ROW-BANK interleave:	ENABLED													
//=============================================================================														
		
DATA 4 0x30391000 0x00000002 	// deassert presetn													
DATA 4 0x307A0000 0x01040001 	// DDRC_MSTR													
DATA 4 0x307A0064 0x00200050 	// DDRC_RFSHTMG													
DATA 4 0x307a0490 0x00000001 	// DDRC_PCTRL_0													
DATA 4 0x307A00D4 0x00690000 	// DDRC_INIT1 (if using LPDDR3/LPDDR2, this line is automatically commented out)													
DATA 4 0x307A00D0 0x00020083 	// DDRC_INIT0													
//DATA 4 0x307A00D8 0x00000000 	// DDRC_INIT2  (if using DDR3 or LPDDR3 this line is automatically commented out) 													
DATA 4 0x307A00DC 0x09300004 	// DDRC_INIT3													
DATA 4 0x307A00E0 0x04880000 	// DDRC_INIT4													
DATA 4 0x307A00E4 0x00100004 	// DDRC_INIT5													
DATA 4 0x307A00F4 0x0000033F 	// DDRC_RANKCTL													
DATA 4 0x307A0100 0x09080809 	// DDRC_DRAMTMG0													
DATA 4 0x307A0104 0x0007020D 	// DDRC_DRAMTMG1													
DATA 4 0x307A0108 0x03040407 	// DDRC_DRAMTMG2													
DATA 4 0x307A010C 0x00002006 	// DDRC_DRAMTMG3													
DATA 4 0x307A0110 0x04020205 	// DDRC_DRAMTMG4													
DATA 4 0x307A0114 0x03030202 	// DDRC_DRAMTMG5													
//DATA 4 0x307A0118 0x02020005 	// DDRC_DRAMTMG6													
//DATA 4 0x307A011C 0x00000202 	// DDRC_DRAMTMG7													
DATA 4 0x307A0120 0x00000803 	// DDRC_DRAMTMG8													
DATA 4 0x307A0180 0x00800020 	// DDRC_ZQCTL0													
//DATA 4 0x307A0184 0x02000100 	// DDRC_ZQCTL1													
DATA 4 0x307A0190 0x02098204 	// DDRC_DFITMG0													
DATA 4 0x307A0194 0x00030303 	// DDRC_DFITMG1													
DATA 4 0x307A01A0 0x80400003 	// DDRC_DFIUPD0													
DATA 4 0x307A01A4 0x00100020 	// DDRC_DFIUPD1													
DATA 4 0x307A01A8 0x80100004 	// DDRC_DFIUPD2													
DATA 4 0x307A0200 0x0000001F 	// DDRC_ADDRMAP0													
DATA 4 0x307A0204 0x00080808 	// DDRC_ADDRMAP1													
DATA 4 0x307A020C 0x00000000 	// DDRC_ADDRMAP3													
DATA 4 0x307A0210 0x00000F0F 	// DDRC_ADDRMAP4													
DATA 4 0x307A0214 0x07070707 	// DDRC_ADDRMAP5													
DATA 4 0x307A0218 0x07070707 	// DDRC_ADDRMAP6													
DATA 4 0x307A0240 0x06000604 	// DDRC_ODTCFG													
DATA 4 0x307A0244 0x00000001 	// DDRC_ODTMAP														

//=============================================================================														
// PHY Control Registers														
//=============================================================================														
														
DATA 4 0x30391000 0x00000000	// deassert presetn													
DATA 4 0x30790000 0x17420F40	// DDR_PHY_PHY_CON0													
DATA 4 0x30790004 0x10210100	// DDR_PHY_PHY_CON1																									
DATA 4 0x30790010 0x00060807	// DDR_PHY_PHY_CON4													
DATA 4 0x307900B0 0x1010007E	// DDR_PHY_MDLL_CON0 																									
DATA 4 0x3079009C 0x00000D6E	// DDR_PHY_DRVDS_CON0													
 													
				
DATA 4 0x30790030 0x04040404	// DDR_PHY_OFFSET_WR_CON0													
DATA 4 0x30790020 0x0A0A0A0A	// DDR_PHY_OFFSET_RD_CON0													
DATA 4 0x30790050 0x01000010	// DDR_PHY_OFFSETD_CON0													
DATA 4 0x30790050 0x00000010	// DDR_PHY_OFFSETD_CON0													
DATA 4 0x30790018 0x0000000F	// DDR_PHY_LP_CON0													
DATA 4 0x307900C0 0x0E407304	// DDR_PHY_ZQ_CON0 - Start Manual ZQ													
DATA 4 0x307900C0 0x0E447304														
DATA 4 0x307900C0 0x0E447306	
CHECK_BITS_SET 4 0x307900c4 0x1										
DATA 4 0x307900C0 0x0E447304																										
DATA 4 0x307900C0 0x0E407304	// DDR_PHY_ZQ_CON0 - End Manual ZQ													
																										
//=============================================================================														
// Final Initialization start sequence														
//=============================================================================														
														
DATA 4 0x30384130 0x00000000	//Disable Clock													
DATA 4 0x30340020 0x00000178	// IOMUX_GRP_GRP8 - Start input to PHY													
DATA 4 0x30384130 0x00000002	//Enable Clock													
//	<= NOTE: Depending on JTAG device used, may need ~ 250 us pause at this point.	
DATA 4 0x30790018 0x0000000f
CHECK_BITS_SET 4 0x307a0004 0x1